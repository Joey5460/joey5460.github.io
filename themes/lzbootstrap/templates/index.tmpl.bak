## -*- coding: utf-8 -*-
<%namespace name="helper" file="index_helper.tmpl"/>
<%namespace name="math" file="math_helper.tmpl"/>
<%namespace name="comments" file="comments_helper.tmpl"/>
<%namespace name="pagination" file="pagination_helper.tmpl"/>
<%namespace name="feeds_translations" file="feeds_translations_helper.tmpl" import="*"/>
<%inherit file="base.tmpl"/>

<%block name="extra_head">
    ${parent.extra_head()}
    % if posts and (permalink == '/' or permalink == '/' + index_file):
        <link rel="prefetch" href="${posts[0].permalink()}" type="text/html">
    % endif
    ${math.math_styles_ifposts(posts)}
</%block>

<%block name="content">
<%block name="content_header">
    ${feeds_translations.translation_link(kind)}
</%block>
% if 'main_index' in pagekind:
    ${front_index_header}
% endif
% if page_links:
    ${pagination.page_navigation(current_page, page_links, prevlink, nextlink, prev_next_links_reversed)}
% endif
<div class="postindex">
<div class="pure-g">
  % for post in posts:
    <div class="pure-u-1-5">
      <div class="pc-index-meta">
        <time datetime="${post.formatted_date('webiso')}"
              class="pc-index-meta-date">
##              ${comp.fancy_date(post.date)}
                ${post.formatted_date(date_format)}
        </time>
##         <div class="pc-index-meta-category">
##           ## TODO: figure out how to display the category
##         </div>
        <div class="pc-index-meta-tags">
          % for tag in post.tags:
            <span class="pc-index-meta-tag">${tag}</span>
          % endfor
        </div>
##         <div class="pc-index-meta-reading-time">
##           ${post.reading_time}
##         </div>
      </div>
    </div>

    <div class="pure-u-4-5">
      <article class="pc-index-post">
        <h2 class="pc-index-post-title">
          <a href="${post.permalink()}" class="pc-index-post-link">
            ${post.title()}
          </a>
        </h2>
        <h3 class="pc-index-post-subtitle">
          ${post.description()}
        </h3>
        % if include_content and not exclude_index_content:
          <div class="pc-index-post-body">
            ${post.text(teaser_only=index_teasers)}
          </div>
        % endif
      </article>
    </div>
  % endfor
</div>

</div>
${helper.html_pager()}
${comments.comment_link_script()}
${math.math_scripts_ifposts(posts)}
</%block>
